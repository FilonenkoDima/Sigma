Використав LINQ, з методом вкладених запитів в операціїї групування в класі DataProcessing в методі GetStatistics